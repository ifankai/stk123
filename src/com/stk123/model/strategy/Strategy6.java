package com.stk123.model.strategy;

import java.sql.Connection;
import java.util.ArrayList;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;

import com.stk123.model.Index;
import com.stk123.model.K;
import com.stk123.task.StkUtils;
import com.stk123.tool.util.EmailUtils;

public class Strategy6 extends Strategy {
	
	private final static String img = "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";

	@Override
	public void run(Connection conn, String today) throws Exception {
		List<Index> results = new ArrayList<Index>();
		for(Index index : indexs){
			if(index.isStop(today))continue;			
			K k = index.getK(today);
			if(k==null)continue;
			
			K yk = k.before(1);
			double ma10 = k.getMA(K.Close, 10);
			double ma20 = k.getMA(K.Close, 20);
			double ma60 = k.getMA(K.Close, 60);
			double yma20 = yk.getMA(K.Close, 20);
			double yma60 = yk.getMA(K.Close, 60);
			if(ma10 > ma20 && ma20>=yma20 && ma60<=yma60){
				double times = k.getVolumeMA(5);
				if(k.isDecrementVolume(3) && times > 2){
					K h5 = k.getKByHHV(5); 
					if(!h5.getDate().equals(k.getDate())){
						K kv5 = k.getKByHVV(5);
						K kv100 = k.getKByHVV(100);
						if(kv5.getVolumn()*1.2 >= kv100.getVolumn()){
								//System.out.println(index.getCode()+","+index.getName()+",change="+index.changePercent);
								index.changePercent = times;
								results.add(index);
						}
					}
				}
			}
		}
		
		if(results.size() > 0){
			Collections.sort(results, new Comparator<Index>(){
				@Override
				public int compare(Index o1, Index o2) {
					int i = (int)((o2.changePercent - o1.changePercent)*10000);
					return i;
				}});
			/*for(Index index : results){
				System.out.println(index.getCode()+","+index.getName()+",change="+index.changePercent);
			}
			System.out.println(StkUtils.join(results, ","));*/
			EmailUtils.sendAndReport("模型6-放量后连续3日缩量,个数："+results.size()+",日期:"+today,
					"1.放量后缩量3日<br>"+
					"2.近期放的大量和前面100日内放的大量基本持平或大于<br>"+
					"3.20日均线持平或上升，60日均线下降或持平<br>"+
					StkUtils.getImgBase64(img)
					+ "<br><br>" +
					StkUtils.createHtmlTable(today, results));
		}

	}

}
